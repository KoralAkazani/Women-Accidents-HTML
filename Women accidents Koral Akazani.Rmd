---
title: השפעת גורמים דמוגרפיים ותנאי דרך על כמות תאונות הדרכים בישראל בקרב נשים בשנת
  2022
author: "Koral Akazani"
date: "25/08/2024"
output:
  html_document:
        code_folding: show
---
<style>
  body {
    direction: rtl; 
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```
<div dir="rtl">
## מבוא
##### כידוע תאונות דרכים בעולם בכלל ובישראל בפרט, הן בעיה חמורה מאוד אשר מספר הנפגעים בה עולה משנה לשנה. לאחר מחקר שביצעתי אף גיליתי כי מספר הנהרגים בתאונות דרכים גדול ממספר ההרוגים במלחמות ישראל. בנוסף, החלטתי לחקור את הנושא של תאונות הדרכים בהתמקדות בנשים כדי לדעת מה הגורמים לתאונות הדרכים ואיך ניתן לצמצם אותן.
</div>
<div dir="rtl">
##### במהלך המחקר אתמקד בקבוצת אוכלוסיה "נשים" בדגש על נשים נוהגות עם רישיון נהיגה A, B, C, D מתוך נתוני הלשכה המרכזית לסטטיסטיקה עם נתונים עדכניים לשנת 2022.
</div>
***
<div dir="rtl">
עבור תחילת העבודה עם הנתונים, אטען את כל החבילות שאעשה בהן שימוש.
</div>

<div dir="ltr">
```{r,echo=TRUE}
library(tidyverse)   ##include ggplot2,dplyr, helps at "group by", manipulation, etc.
library(broom)       ## for the table of all the tests
library(plotrix)     ##for 3D pie chart
library(reshape2) #merging data sets
library(vcd) #Visualization of Chi - test, Cramer
library(stats) #R statistical function
library(plotly) #interactive graphs
library(lsr) #Cramer's calculation
library(gplots) #extra graph - heatmap
library(grid) #control the layout 
library(RColorBrewer) #creating build R palette
library(plot3D)
library(rgl)
library(ggthemes)
library(car)#VIF
library(lmtest)
library(jpeg)
library(gt) #Advanced design for tables
library(kableExtra)
library(htmltools)
```
</div>

<div dir="rtl">
בכדי לענות על שאלת המחקר אאחד את שני קבצי הנתונים ע"י עמודה משותפת, אסנן ערכים כפולים וריקים ואצור את הטבלה עם העמודות הרלוונטיות עבור שאלת המחקר 
</div>

<div dir="ltr">
```{r, echo=TRUE}
# Reading data files 
data1 <- read.csv("C:\\Users\\Dell\\OneDrive\\women road accidents group 5\\H20221161AccData.csv" , header = TRUE)
data2 <- read.csv("C:\\Users\\Dell\\OneDrive\\women road accidents group 5\\H20221161InvData.csv" , header = TRUE)

# Merging the files by a common column
mergeData <- merge(data1,data2,by = "pk_teuna_fikt")

#Create merge data with the columns we need for this project

#selecting the wanted columns
all_mergedata <- mergeData %>% select(pk_teuna_fikt, MIN, YOM_BASHAVUA, EZOR_TIVI_MEGURIM, SUG_TEUNA, ZURAT_DEREH, KVUZA_GIL, ZURAT_ISHUV_MEGURIM, YOM_LAYLA, HUMRAT_PGIA, SUG_DEREH)
                                      

# Remove duplicates based on the 'pk_teuna_fikt' column
all_mergedata <- all_mergedata %>% distinct(pk_teuna_fikt, .keep_all = TRUE)

#Delete NA values
Final_mergeData <- na.omit(all_mergedata)

#Final data - from here we will use this data
Final_mergeData <- as.data.frame(Final_mergeData)

# Print the resulting data frame
#print(Final_mergeData)
```
</div>
<div dir="rtl">
#### **האם קיים הבדל מובהק סטטיסטית בסוגי התאונות שביצעו נהגים בצורות דרכים שונות?** 
#### **אם כן, מה סוג התאונה וצורת הדרך הנפוצים ביותר בקרב נשים?**
</div>

<div dir="rtl">
על מנת לענות על שאלת המחקר, בחרתי מתוך בסיס הנתונים שהטענו את שלושת העמודות הרלוונטיות לצורך מענה על שאלת המחקר. העמודות הן: סוג תאונה, צורת דרך ומין. כאשר צורת דרך מתייחסת לצורות כמו כניסה למחלף, עקומה חדה, כביש ישר וכדומה.
לצורך הנוחות ייצרתי מילון כאשר לכל מין, סוג תאונה וצורת דרך קיים שם.
</div>
<div dir="ltr">
```{r,echo=FALSE}
#Column select
accColumns <- Final_mergeData %>% select(SUG_TEUNA, ZURAT_DEREH, MIN )

#Removing rows with no relevant values
accColumns<-accColumns[!(accColumns$MIN %in% c(0)) , ]

head(accColumns)

#1- Dictionary for MIN 
accColumns$MIN[accColumns$MIN == 1] <- "Man"
accColumns$MIN[accColumns$MIN == 2] <- "Woman"

# 2- Create groups for similar accidents types
accColumns <- accColumns %>%
  mutate(SUG_TEUNA = case_when(
    SUG_TEUNA %in% c(1) ~ "Injury to a pedestrian",  
    SUG_TEUNA %in% c(2,5) ~ "Head-on collision",
    SUG_TEUNA %in% c(3,7,17,18) ~ "Rear-end collision",  
    SUG_TEUNA %in% c(4,6) ~ "Side by side collision",
    SUG_TEUNA %in% c(8,14,15,19,20) ~ "Other",
    SUG_TEUNA %in% c(10,13) ~ "Overturning",
    SUG_TEUNA %in% c(9,11,12) ~ "Slip",
    TRUE ~ as.character(SUG_TEUNA)      
  ))

# 3- Create groups for similar road types
accColumns <- accColumns %>%
  mutate(ZURAT_DEREH = case_when(
    ZURAT_DEREH %in% c(1,2) ~ "Exit/Entrance to Interchange",
    ZURAT_DEREH %in% c(4,5) ~ "Sharp Slope/Curve",
    ZURAT_DEREH %in% c(6,8,10) ~ "Straight road/junction",
    ZURAT_DEREH %in% c(9) ~ "Other",
    TRUE ~ as.character(ZURAT_DEREH)      
  ))
```
<div/>
<div dir="rtl">
לאחר הכנת המילון, ארכיב שתי טבלאות עבור סוגי התאונות וצורות הדרך אשר יכילו את כלל סוגי התאונות וצורות הדרך:
<div/>
<div class="center-plot">
```{r,echo=FALSE}
##Summary tables of the types of roads and accidents which exist at this question
# Extract unique road types
unique_road_types <- accColumns %>%
  select(ZURAT_DEREH) %>%
  distinct()

# Extract unique accident types
unique_accident_types <- accColumns %>%
  select(SUG_TEUNA) %>%
  distinct()

# Create the tables
table_road <- unique_road_types %>%
  gt() %>%
  tab_header(title = "Road Types") %>%
  cols_label(ZURAT_DEREH = "Road Types")

table_accident <- unique_accident_types %>%
  gt() %>%
  tab_header(title = "Accident Types") %>%
  cols_label(SUG_TEUNA = "Accident Types")

# Convert gt tables to data frames
df_road <- as.data.frame(table_road)
df_accident <- as.data.frame(table_accident)

# Create tables using kable
table_road_kable <- kable(df_road, format = "html", escape = FALSE, col.names = "Road Types") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))

table_accident_kable <- kable(df_accident, format = "html", escape = FALSE, col.names = "Accident Types") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))

# Combine the tables side by side and center on the page
htmltools::browsable(
  tagList(
    tags$div(
      style = "display: flex; justify-content: center; align-items: flex-start; gap: 50px;",  # Align tables at the top
      tags$div(
        HTML(table_road_kable)
      ),
      tags$div(
        HTML(table_accident_kable)
      )
    )
  )
)
# Define Mode function
Mode <- function(x) {
  ux <- unique(x)
  mode_val <- ux[which.max(tabulate(match(x, ux)))]
  freq <- max(tabulate(match(x, ux)))
  attr(mode_val, "freq") <- freq
  return(mode_val)
}

```
<div/>
<div dir="rtl">
#### **סטטיסטיקה היסקית**
</div>
<div dir="rtl" class="underlined-large-heading">
**המבחן הסטטיסטי:**
</div>
<div dir="rtl">
מבחן ANOVA דו כיווני, כאשר:

Y - משתנה נומרי המייצג את כמות התאונות

X1 - משתנה קטגוריאלי המייצג צורת הדרך

X2 - משתנה קטגוריאלי המייצג סוג תאונה

**המודל** : 
𝒀𝒊𝒋 = 𝝁 + 𝜶𝒊 + 𝜷𝒋 + 𝜸𝒊𝒋 + 𝜺𝒊𝒋  

**הגדרת משתנים : **

𝒀𝒊𝒋 – כמות תאונות הדרכים שנצפו בתאונה מסוג i בצורת דרך j. 

𝝁 – הממוצע של מספר התאונות על פני כל סוגי התאונות וצורות הדרכים.

𝜶𝒊 – ההשפעה של סוג התאונה i על כמות התאונות. 

𝜷𝒋 - ההשפעה של צורת הדרך j על כמות התאונות. 

𝜸𝒊𝒋 - אפקט אינטראקציה בין סוגי התאונות לצורות הדרכים, כלומר ההשפעה המשותפת של סוג תאונה i וצורת דרך j על כמות התאונות.

𝜺𝒊𝒋 - הטעות האקראית.
</div>

<div dir="rtl">
**השערת המחקר :** קיים הבדל בין סוגי התאונות שביצעו נהגים בצורות דרכים שונות, וישנה השפעה של צורת הדרך על סוג התאונה.

**מבחן השערות :**

**H0** : אין הבדל מובהק סטטיסטית בין סוגי התאונות שביצעו נהגים בצורות דרכים שונות.

**H1** : יש הבדל מובהק סטטיסטית בין סוגי התאונות שביצעו נהגים בצורות דרכים שונות.

**הנחות המודל :**
</div>
<div dir="rtl">

1. המשתנים בלתי תלויים זה בזה בין הקבוצות ובתוך הקבוצות כלומר - $𝜺𝒊𝒋~ N(0,σ^{2})$, במידה ויש קשר, יש למצוא את עוצמת הקשר.  

2. המשתנים מתפלגים בהתאם להתפלגות נורמלית.

3. קיים שיוויון שונויות בין המשתנים - במידה ונמצאה נורמליות, יש לבצע בדיקה האם השונויות הומוגניות כלומר ישנה הומוסקדסטיות בין הקבוצות.
</div>
<div dir="rtl">
  
</div>
<div dir="rtl">
#### **סטטיסטיקה תיאורית**
</div>
<div dir="rtl">
בסיכום הבא ניתן לראות את הערכים המינימליים והמקסימליים, הממוצע, חציון, רבעונים ראשון ושלישי וסטיית תקן של כמות סוגי התאונות בחלוקה לגברים ונשים בשנת 2022. 
</div>
<div dir="ltr">
```{r, echo=FALSE}
#Calculate number of accidents for every type of accidents of any gender
acc_summary <- accColumns %>%
  group_by(SUG_TEUNA, MIN) %>%
  summarise(total_accidents = n(), .groups = 'drop')
```

```{r,echo=TRUE}
# Create summary statistics for accident types by genders 
summary_stats <- acc_summary %>%
  group_by(MIN) %>%
  summarise(
    Min = min(total_accidents),
    `1st Qu.` = quantile(total_accidents, 0.25),
    Median = median(total_accidents),
    Mean = mean(total_accidents),
    `3rd Qu.` = quantile(total_accidents, 0.75),
    Max = max(total_accidents),
    SD = sd(total_accidents)
  )
```

```{r, echo=FALSE}
# Convert the data frame to a matrix and remove the column names
summary_stats <- as.data.frame(lapply(summary_stats, function(x) format(x, digits = 1)))
colnames(summary_stats)[-1] <- c("Min", "1st Qu.", "Median", "Mean", "3rd Qu.", "Max", "SD")

print(summary_stats)
```
</div>
<div dir="rtl">
נראה שמספר התאונות הנמוך ביותר הוא בקרב נשים. 
</div>
<div dir="rtl">
ניתן לראות גם שכמות התאונות המקסימלית הגבוהה ביותר היא 8,432 תאונות אשר מתקיימות גם בקרב גברים.
נראה גם כי לכ- 25% מסך סוגי התאונות (רבעון ראשון) יש פחות מ- 2,016 תאונות עבור גברים ופחות מ-1,239 תאונות עבור נשים, כאשר ברבעון השלישי, כלומר ל- 75% מסך סוגי התאונות, יש פחות מ- 2,768 תאונות עבור גברים ופחות מ - 1,407 תאונות עבור נשים. 
</div>
<div dir="rtl">
ל- 50% מסוגי התאונות כלומר לחציון יש פחות מ- 2,302 תאונות בקרב גברים ופחות מ-1,341 תאונות בקרב נשים.
ניתן לציין כי אצל גברים ממוצע התאונות הוא 2,991 תאונות בעוד שאצל נשים הממוצע נמוך יותר ועומד על 1,814 תאונות.
</div>
<div dir="rtl">
בניתוח הסטטיסטיקה נראה כי גם עבור גברים וגם עבור נשים סטיית התקן נמוכה מהממוצע מה שמעיד על פיזור תקין של סטיות הנתונים וכי הנתונים בעלי אחידות מסויימת, אם כי אדגיש שסטיית התקן עדיין גדולה לא מעט.
</div>
<div dir="rtl" class="underlined-large-heading">
##### **הצגה ויזואלית של הסטטיסטיקה התיאורית:**
</div>
<div style="text-align:center;">
```{r, echo=FALSE, fig.width=14, fig.height=12}
#######After statistics########
###Distribution Graph - Stacked bar plot

# Creating table by road shape and count of accidents
table_G <- table(accColumns$ZURAT_DEREH, accColumns$SUG_TEUNA)
table_G <- as.data.frame.table(table_G)
colnames(table_G) <- c("ZURAT_DEREH", "SUG_TEUNA", "Freq")

# Create sum of frequencies of all the combinations of type of road and type of accident
Frame_group <- aggregate(Freq ~ ZURAT_DEREH + SUG_TEUNA, data = table_G, FUN = sum)

# Creating dictionary with the sum of accidents for shape of roads
Total_Accidents_Dictionary <- setNames(sapply(unique(Frame_group$ZURAT_DEREH), function(group_val) {
  sum(Frame_group$Freq[Frame_group$ZURAT_DEREH == group_val])
}), unique(Frame_group$ZURAT_DEREH))

# Creating and adding new column of total accidents
Frame_group$TOTAL_ACCIDENT <- sapply(Frame_group$ZURAT_DEREH, function(group_val) {
  Total_Accidents_Dictionary[[group_val]]
})

# Creating percentage by freq part total
Frame_group$Percentages <- round(((Frame_group$Freq / Frame_group$TOTAL_ACCIDENT) * 100), 2)

# Filtering values different from zero percent
Frame_group <- Frame_group %>%
  filter(Percentages != 0)

# Ensure the `SUG_TEUNA` is a factor with levels in the same order across all rows
unique_SUG_TEUNA <- unique(Frame_group$SUG_TEUNA)
Frame_group$SUG_TEUNA <- factor(Frame_group$SUG_TEUNA, levels = unique_SUG_TEUNA)

# Reorder `ZURAT_DEREH` factor levels based on total number of accidents
Frame_group$ZURAT_DEREH <- factor(Frame_group$ZURAT_DEREH, levels = names(Total_Accidents_Dictionary[order(Total_Accidents_Dictionary)]))

# GGplot graph
Gplot <- ggplot(Frame_group, aes(x = ZURAT_DEREH, y = Percentages, fill = SUG_TEUNA)) +
  geom_bar(stat = "identity") +  # height of bars by percentages of type of road
  labs(title = "Distribution of accidents by type of road and type of accident",
       x = "Type of road",
       y = "Percentage of accidents",
       fill = "Type of accident") +
  geom_text(aes(label = paste0(Percentages, "%")), # puts percentages on top of all bars
            position = position_stack(vjust = 0.5), size = 6) + # size and position of the % on the bars
  theme(plot.margin = unit(c(0.5, 0.1, 0.5, 0.1), "cm"), # the total plot margin - top, bottom, left, right
        plot.title = element_text(hjust = 0.6, size = 28, face = "bold"), # "face" - to make the title bold
        axis.title.x = element_text(size = 20, margin = margin(t = 10), face = "bold"), # Negative margin so the title of X axis will get closer to the plot
        axis.title.y = element_text(size = 18, face = "bold"),
        axis.text.x = element_text(angle = 15, hjust = 0.5, margin = margin(r = 0), size = 18), # Tilt the text of the axis by 15 degrees
        axis.text.y = element_text(size = 18), # Increasing the font size at Y axis
        legend.title = element_text(size = 22, hjust = 0.3, face = "bold"), # Increasing the size of the legend's title
        legend.text = element_text(size = 20), # Increasing the font size at the legend
        panel.background = element_blank())
```
```{r, fig.width=14, fig.height=12, echo=FALSE}
print(Gplot)
ggsave("accidents_by_road_type.png", plot = Gplot, width = 14, height = 12, dpi = 600)

```
</div>
<div dir="rtl">
במבט ראשוני ניתן לראות כי סוגי התאונות הנפוצים ביותר בקרב נשים וגברים יחד הם התנגשות "אחור בחזית" (Rear-end collision) ו"התנגשות חזיתית" (Head-on collision).
</div>
<div dir="rtl">
בנוסף, ניתן לראות עבור איזה מין, מהו סוג התאונה הנפוץ ביותר ובאיזה צורת דרך כמות התאונות בשנת 2022 היא הגדולה ביותר:
</div>
<div dir="ltr">
```{r, echo=FALSE}
#Now after statistic, I will find the most common accident type, road shape and gender 

# Find most common accident type
most_commonType <- Mode(accColumns$SUG_TEUNA)
num_most_commonType <- attr(most_commonType, "freq")
print(most_commonType)

# Find most common road shape
most_common_roadShape <- Mode(accColumns$ZURAT_DEREH)
num_most_common_roadShape <- attr(most_common_roadShape, "freq")
print(most_common_roadShape)

# Find most common gender
most_commonGender <- Mode(accColumns$MIN)
num_most_commonGender <- attr(most_commonGender, "freq")
print(most_commonGender)
```
</div>
<div dir="rtl">
נראה שסוג התאונה הנפוץ ביותר הוא "התנגשות אחור בחזית" בצורת דרך "אחר" כאשר המין בעל כמות התאונות הגבוהה ביותר הוא "גברים".
</div>
<div dir="rtl">
אציג את ההתפלגות של שכיחות סוג התאונה, צורת הדרך והמין בעזרת גרף עוגה תלת מימדי וגרף עמודות:
</div>
<div dir="ltr">
```{r, echo=FALSE}
######Creating some graphs to show the frequencies visually I have found 

# Creating data frame
summary_table <- data.frame(
  Category = c("Type of Accident", "Road Shape", "Gender"),
  Most_Common = c(most_commonType, most_common_roadShape, most_commonGender),
  Frequency = c(num_most_commonType, num_most_common_roadShape, num_most_commonGender)
)
print(summary_table)
```
</div>
<div class="center-plot">
```{r, echo=FALSE}
# Graph 1 - bar plot for showing the most common Gender, Road Shape and Type of accident

# Creating bar plot with labels
ggplot(summary_table, aes(x = Category, y = Frequency, fill = Category)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  geom_text(aes(label = paste(Most_Common, "\n(", Frequency, ")", sep = "")), 
            vjust = 2.5, size = 5) +
  scale_fill_brewer(palette = "Set3") +  # R palette
  labs(title = "Most Common Values",
       x = "Category",
       y = "Frequency") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 20, face = "bold"),
        axis.title = element_text(size = 16, face = "bold"),
        axis.text = element_text(size = 16, face = "bold"),
        panel.background = element_blank())
ggsave("Most_Common_Values.png", width = 10, height = 6, dpi = 480) # save as photo
```
<div class="center-plot">
```{r, echo=FALSE}
### graph 2 - 3D pie  ### Mordi - Please check for me this graph of Koral
# Creating data frame

# summary table
#summary_table from the data frame I created above

# Using custom colors
custom_colors <- c("#66c2a5", "#fc8d62", "#8da0cb")
par(mfrow = c(1, 1), mar = c(0, 0, 0, 5), cex.main = 1.5) # mfrow - 1 graph at a time, mar - margin settings

# Function to create 3D pie chart
#create_pie_chart <- function() {
labels_with_values <- paste(summary_table$Frequency) # Create labels with frequency values

# Creating 3D pie chart
pie3D(summary_table$Frequency,
      explode = 0.1,   # Gap between the slices of the pie
      theta = 0.8,   # Viewing angle in radians
      col = custom_colors,
      labelcex = 2,  # Size of the labels on the slices 
      main = "Most Common Attributes",  # Title of the pie chart
      radius = 1,# Radius of the pie
      cex.main = 1.5 ) #size of title
  
# Function to calculate the position of the labels on the pie
get_label_positions <- function(frequencies) {
  total <- sum(frequencies)
  angles <- cumsum(frequencies) / total * 2 * pi
  angles <- angles - frequencies / total * pi
  return(angles)
}

# Calculate positions for labels
label_angles <- get_label_positions(summary_table$Frequency)


# Adding the labels on the cake - each label as a position by X & Y coordinates 
for (i in seq_along(summary_table$Frequency)) {
  angle <- label_angles[i]
  x <- cos(angle) * 0.6 
  y <- sin(angle) * 0.3
  
  # Adding the text on the slices with different parameters (size, color, position)
  text(x, y, labels_with_values[i], cex = 1.5, col = "black", pos = 3)
}

# Creating legend
# Calculate the width of the text in the legend
text_widths <- strwidth(paste(summary_table$Category, summary_table$Most_Common), units = "inches")
max_width <- max(text_widths) # Maximum width of legend text

# Create custom legend using grid
#Mode of adding a legend by X,Y, width and height position
pushViewport(viewport(x = unit(0, "npc"), y = unit(0.6, "npc"), width = unit(0.28, "npc"), height = unit(0.5, "npc")))
for (i in seq_along(summary_table$Category)) {
  grid.rect(x = unit(0.85, "npc"),  # Position and size of legend rectangles
            y = unit(1 - (i - 1) * 0.15, "npc"), 
            width = unit(0.3, "inches"), 
            height = unit(0.3, "inches"), 
            gp = gpar(fill = custom_colors[i], col = "black")) # Color of the legend squares
  grid.text(label = paste(summary_table$Category[i], ":", summary_table$Most_Common[i]), # Text in the legend
            x = unit(0.94, "npc"), 
            y = unit(0.99 - (i - 1) * 0.15, "npc"), 
            hjust = 0, 
            vjust = 0, 
            gp = gpar(fontsize = 14))
}
popViewport()
#npc = normalized parent coordinates -The position is determined in relation to the calculated height and width.
```
</div>
<div dir="rtl">
**הערה:** יש לבדוק גרף פאי תלת מימדי זה כחלק ממתן הציון 
</div>
<div dir="rtl" class="underlined-large-heading">
##### **בדיקת הנחות מודל ANOVA TWO-WAY:**
</div>
<div dir="rtl">
##### **בדיקת הנחת תלות בין המשתנים - **
</div>
<div dir="rtl">
ראשית נבדוק את ההנחה כי קיימת תלות בין המשתנים. כדי לבצע את הבדיקה אשתמש במבחן Chi - squared בעזרתו נבדוק האם קיימת תלות בין משתני סוג התאונה וצורת הדרך.
</div>

**השערות המבחן:**

**H0** : אין תלות בין סוגי התאונות וצורות הדרכים השונות.

**H1** : יש תלות בין סוגי התאונות שביצעו וצורות הדרכים השונות.
<div/>
<div dir="ltr">
```{r, echo = FALSE}

######ANOVA two-way assumption 1 - Testing for independence between the variables

##Chi-test check

##Chi-test - Hypotheses
#cat("H0 : There is no connection between the variables", "\n")
#cat("H1 : There is a connection between the variables", "\n")

# Create a frequency table
chi_table <- table(accColumns$ZURAT_DEREH, accColumns$SUG_TEUNA)
print(chi_table)

# Perform Chi-squared test of independence
chi_square_test <- chisq.test(chi_table, correct = TRUE)

# Print test results
print(chi_square_test)

#Making final Decision
if (chi_square_test$p.value < 0.05) {
  cat("P-Value is : ",chi_square_test$p.value, "\n", "Desicion - Reject HO hypothesis (Accept H1)." ,"\n", 
      "There is a connection between the different road shapes and the types of accidents.\n")
} else {
  cat("P-Value is : ",chi_square_test$p.value, "\n", "Desicion - Accept the HO hypothesis.","\n", 
      "There is no connection between the different road shapes and the types of accidents.\n")
}
```
</div>
<div dir="rtl">
כמסקנה אוכל לומר כי מאחר ו- P-value < 5% אזי אדחה את H0 ברמת מובהקות 5%, ואסיק כי קיימת תלות בין צורות הדרך וסוגי התאונות שביצעו הנהגים. 
</div>
<div dir="rtl">
אוכל להציג את המסקנה גם באופן גרפי על ידי גרף אסוציאציה שמטרתו להמחיש את הקשר בין שני המשתנים הקטגוריים - סוג תאונה וצורת דרך בהתבסס על תוצאות מבחן חי בריבוע.
</div>
</div>
<div dir="rtl" class="underlined-large-heading">
##### **הצגה ויזואלית של הנחת התלות בין המשתנים בעזרת גרף אסוציאציה:**
</div>
<div style="text-align:center;">
```{r, echo=FALSE, fig.width=10, fig.height=8}
#Visual result

#Creating a frequency table
chi_table <- table(accColumns$ZURAT_DEREH, accColumns$SUG_TEUNA)

# Association graph with label resizing and spacing
# Adjusting the direction of the labels on the X and Y axis
labeling_args <- list(gp = gpar(cex = 0.5), rot_labels = c(45, 45, -60, -60))
assoc(chi_table, 
      shade = TRUE, 
      legend = TRUE, 
      main = "Association Plot of Road Type and Accident Type",
      spacing = spacing_conditional(sp = 2),
      gp_labels = gpar(cex = 1, col = "black", font = 2),
      gp_axis = gpar(cex = 1),
      labeling_args = labeling_args,
      title_margin = 4,
      mar = c(6, 0, 0, 4) # Adjust margins if supported
)
```
</div>
<div dir="rtl">
נראה כי הציר האופקי מתאר את סוגי התאונות שביצעו נהגים והציר האנכי מתאר את צורות הדרך בהן נעשו התאונות, כאשר הקווים בגרף מייצגים את השאריות של פרסון (Pearson residuals), שהם ההפרש בין הערכים שנצפו בפועל לבין הערכים הצפויים בהינתן שאין קשר בין המשתנים.
</div>
<div dir="rtl">
אורך הקווים מייצג את גודל השאריות: קו ארוך יותר מייצג שארית גדולה יותר.
אם הקו מתרומם מעל הציר האופקי, המשמעות היא שכמות המקרים שנצפתה גבוהה יותר מהצפוי. אם הקו יורד מתחת לציר, המשמעות היא שכמות המקרים שנצפתה נמוכה מהצפוי.
</div>
<div dir="rtl">
את גודל השאריות מתארים הצבעים, כאשר צבע כחול כהה יותר, יתאר שאריות חיוביות גבוהות ולעומת זאת, צבע אפור כהה יותר, יתאר שאריות שליליות יותר.
אדגיש כי, שאריות גבוהות (חיוביות או שליליות) מראות סטייה מהצפוי, מה שמצביע על תלות בין המשתנים עבור הקטגוריות הרלוונטיות.
</div>
<div dir="rtl">
</div>
<div dir="rtl" class="underlined-large-heading">
 **מסקנות סופיות העולות מן הגרף - **
</div>
<div dir="rtl">
נראה על פי תוצאות הגרף כי:
</div>
<div dir="rtl">
1. בצורת דרך **"יציאה / כניסה למחלף"** רוב סוגי התאונות המתרחשות הן בעלות שארית שלילית, בעוד שסוגי התאונות: **"התנגשות חזיתית"** ו**"התנגשות צד לצד"** בצורת הדרך הזו, הן בעלות שארית חיובית כלומר, שהיו יותר תאונות מסוג זה בצורת הדרך הנ"ל מהצפוי. הקו הכהה המתאר אותם ידגיש את התלות הגבוהה שבין יציאה / כניסה למחלף, לבין התנגשות חזיתית והתנגשות צד בצד.
</div>
<div dir="rtl">
2. עבור צורת דרך **"אחרת"** נראה כי לרוב קיימת תלות והשפעה של צורת דרך זו על סוגי התאונות **"התנגשות אחור בחזית"**, **"החלקה"** ו**"אחר"**, נדע זאת מאחר ובשילוב זה הקו שבגרף עולה כלפי מעלה, כלומר היו יותר תאונות מסוגים אלו מאשר מה שהיה צפוי, זאת לעומת שאר סוגי התאונות בהן הקו יורד כלפי מטה ומתאר שארית שלילית. 
אדגיש כי בצורת דרך **"אחרת"** הקווים שעל הגרף הם רחבים יותר מאשר שאר צורות הדרכים, הדבר מעיד על עוצמת קשר גבוהה מאוד (חיובית או שלילית) בין שילובים אלו. 
את עוצמת הקשר נבדוד בהמשך.
</div>
<div dir="rtl">
3. עבור צורת דרך **"עיקול חד / שיפוע"** נראה כי התלות החיובית החזקה ביותר היא עבור סוג התאונה **"התהפכות"** המתרחש בצורת דרך זו. אוכל להסיק כי ישנה תלות גבוהה יחסית בין השילוב הנ"ל וכי קרו בפועל יותר תאונות מסוג זה מאשר הערך הצפוי.
</div>
<div dir="rtl">
4. עבור צורת דרך **"כביש ישר / צומת"** נראה כי עבור סוגי התאונות **"התנגשות חזיתית"** ו**"פגיעה בהולך רגל"** קיים יותר סיכון, כלומר קרו יותר תאונות מסוג זה מאשר הערך שהיה צפוי להן. הצבע הכחול יתאר עבורנו שארית חיובית גבוהה וברורה המסמלת על סטייה מעלה מהערך הצפוי של סוג תאונות אלו, כלורמ נצפו יותר תאונות בפועל מאשר מה שהיה צפוי.
לעומת זאת, בצורת דרך זו עבור סוג תאונה **"התנגשות אחור בחזית"**, השארית היא שלילית (תיאור ע"י צבע אפור).
</div>
<div dir="rtl">
לסיכום, אוכל לחזק את המסקנה הנקבעה לפי מבחן "חי בריבוע" כי קיים קשר בין סוג התאונה לצורת הדרך. כאשר, על פי הגרף, אוכל גם להסיק כי רוב התאונות אשר מושפעות מצורות הדרך (כלומר קיימת תלות מובהקת), עשויות להתרחש בעקבות עומסים בכבישים, (כמו במקרה של התנגשות חזיתית בכביש ישר או בכניסה למחלף), בעקבות תנאי מזג אוויר המקשים על אחיזה בכביש (כמו במקרה של התהפכות בעיקול חד / שיפוע כאשר במקרה בו אין אחיזה טובה ניתן במקרים מסויימים להתהפך כשהכביש מעוקל), וכדומה.
</div>
<div dir="rtl">
את עוצמת הקשרים שמצאתי, נבדוק כעת באמצעות מבחן קארמר (Cramer's V).
</div>
<div dir="rtl">
##### **מבחן קורלציה Cramer's V לבדיקת עוצמת הקשר בין המשתנים - **
</div>
לאחר שמצאתי כי אכן קיים קשר מובהק בין צורות הדרכים לסוג התאונה, אבדוק את עוצמת הקשר בין המשתנים על-ידי מבחן Cramer’s V.
</div>
<div dir ="ltr">
```{r, echo=FALSE}
#ANOVA two-way assumption 2- Calculation of the strength of the connection between the variables

#After founding that there is a dependency between the variables, I will find what is the The strength of the relationship

# Calculate Cramer's V
contingency_table <- table(accColumns$SUG_TEUNA, accColumns$ZURAT_DEREH)

# Result Cramer's V
result <- assocstats(contingency_table)
print(result)

#Making final Decision
if (result$cramer == 0) {
  cat("There is no connection between the variables.\n")
} else if (result$cramer > 0 && result$cramer <= 0.099) {
  cat("There is a very weak connection between the variables.\n",
      "The connection is :" , result$cramer, "\n")
}else if (result$cramer > 0.099 && result$cramer <= 0.3) {
  cat("There is a weak connection between the variables.\n",
      "The connection is :" , result$cramer, "\n")
}else if (result$cramer > 0.3 && result$cramer <= 0.5) {
  cat("There is a mid connection between the variables.\n",
      "The connection is :" , result$cramer, "\n")
}else if (result$cramer > 0.5 && result$cramer <= 0.7) {
  cat("There is a strong connection between the variables.\n",
      "The connection is :" , result$cramer, "\n")
}else{
  cat("There is a very strong connection between the variables.\n",
      "The connection is :" , result$cramer , "\n")
}

##Verbal final conclusion
cat("conclusion : The test indicates a statistically significant relationship between the two variables, But the strength of the relationship is very weak.\n"
)
```
</div>
<div dir ="rtl">
מבחן Cramer’s V בודקת את עוצמת הקשר בין שני משתנים קטגוריים. מדד המבחן נע בין 0 ל-1 כאשר, 0 מתאר מצב בו אין קשר ו- 1 מתאר מצב של קשר בעוצמה מיטבית. 
במקרה זה, מדד קראמר הינו: 0.019 כלומר קיימת עוצמת קשר חלשה מאוד.
</div>
<div dir ="rtl" class="underlined-large-heading">
**מסקנה:**
</div>
<div dir ="rtl">
המבחן מצביע על קיום קשר בין שני המשתנים אך מתאר את עוצמת הקשר כעוצמה חלשה מאוד.
</div>
<div dir ="rtl">
לאחר ביצוע המבחן אראה את התוצאה גם באופן ויזואלי בעזרת גרף קורלציה.
</div>
<div dir="rtl" class="underlined-large-heading">
##### **הצגה ויזואלית של מבחן הקורלציה לעוצמת הקשר בין המשתנים:**
</div>
<div style="text-align:center;">
```{r, echo=FALSE, fig.width=10, fig.height=8}
# Correlation graph
geom_jitter <- ggplot(accColumns) +
  aes(x = ZURAT_DEREH, y = SUG_TEUNA ) +
  geom_jitter(size = 2, width = 0.5, height = 0.2) +  # adding space
  labs(
    x = "Type of road",
    y = "Type of accident",
    title = "Correlation between Type of road to Type of accident "
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20L, face = "bold", hjust = 0.5),
    axis.title.y = element_text(size = 18L, face = "bold"),
    axis.title.x = element_text(size = 18L, face = "bold", margin = margin(t = 20)),
    axis.text.x = element_text(size = 14L),  
    axis.text.y = element_text(size = 14L), 
    
  )

print(geom_jitter)
```
</div>
<div dir = "rtl">
נראה גם על פי הגרף כי קיים קשר בין סוג התאונה וצורת הדרך אך עוצמת הקשר לרוב היא חלשה.
צפיפות גבוהה של נקודות מתארת קורלציה גבוהה בין משתנים ולהפך, צפיפות נמוכה מציגה קשר חלש.
ניתן לראות על פי הגרף כי עוצמת הקשר החזקה ביותר היא כשסוג התאונה "התנגשות אחור בחזית" מתרחש בצורת דרך "אחרת", כאשר צפיפות הנקודות שם הינה הגבוהה ביותר.
כזכור, בגף האסוציאציות מצאתי כי בצורת דרך "אחרת" קווי הגרף רחבים, כלומר קיים קשר (חיובי / שלילי) בעל עוצמה חזקה במיוחד, נשים לב כי הדבר עולה בקנה אחד עם גרף הקורלציה בו רוב הקשרים החזקים נמצאים בצורת דרך זו.
</div>
<div dir="rtl">
##### **בדיקת הנחת התפלגות נורמלית - **
</div>
על מנת שאוכל לבדוק את שאלת המחקר ולהשתמש במבחן ANOVA דו כיווני, עליי לבדוק קודם לכן, אם המשתנים מתפלגים על פי התפלגות נורמלית. לצורך הבדיקה אשתמש במבחן Shapiro - Wilk  לבדיקת נורמליות: 
</div>
**השערות המבחן:**

**H0** : נתוני התדירות מתפלגים נורמלית.

**H1** : נתוני התדירות אינם מתפלגים נורמלית.
<div/>
<div dir="ltr">
```{r, echo = FALSE}
#ANOVA two-way assumption 3 - Checking if the variables are NORNALLY distributed

##Shapiro wilk test - Hypotheses
#cat("H0 : The Frequency data is normally distributed", "\n")
#cat("H1 : The Frequency data is not normally distributed", "\n")

#Check the Hypotheses with Shapiro wilk test
shapiro_test <- shapiro.test(Frame_group$Percentages)
print(shapiro_test)

##Print result 
cat("P-Value is:", shapiro_test$p.value, "\n")

#Making final Decision
if (shapiro_test$p.value < 0.05) {
  cat("Reject HO hypothesis (Accept H1), The frequency data is not normally distributed.\n")
} else {
  cat("Accept the HO hypothesis, The frequency data is not normally distributed.\n")
}
```
</div>
<div dir="rtl">
כמסקנה אוכל לומר כי מאחר ו- P-value < 5% אזי אדחה את H0 ברמת מובהקות 5%, ואסיק כי נתוני התדירות אינם מתפלגים נורמלית.
אוכל להציג את המסקנה גם באופן ויזואלי:
</div>
<div dir="rtl" class="underlined-large-heading">
##### **הצגה ויזואלית של בדיקת הנחת הנורמליות בעזרת גרף QQ-Plot:**
</div>
<div style="text-align:center;">
```{r, echo=FALSE, fig.width=10, fig.height=8}
###NormalPlot - Showing if there is normal distribution by visual plot

# While Frame_group is my data frame and Percentages is the variable of interest

ggplot(Frame_group, aes(sample = Percentages)) + #variables and data
  stat_qq(size = 2.5) +
  stat_qq_line(color = "red", linewidth  = 1.1) +  # Change line color to red and set line size
  labs(title = "Q-Q Plot of Percentages (Residuals)",
       x = "Quantiles of Normal Distribution",
       y = "Quantiles of Sample Data") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 18),
    axis.title = element_text(size = 16),
    axis.text = element_text(size = 16)
  ) +
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +  # Set breaks for x-axis
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5))    # Set breaks for y-axis
```
</div>
<div dir = "ltr">
```{r, echo=FALSE}
#Verbal result according to the graph
cat("The frequency data is not normally distributed", "\n", 
    "The residuals are not arranged at 45 degrees according to the red qqline.", "\n")

```
</div>
<div dir="rtl">
כמסקנה ניתן לראות כי גם על פי מבחן שפירו - וילק וגם לפי גרף QQ-Plot נתוני התדירות לא מתפלגים נורמלית, כך שהנחת הנורמליות עבור מבחן ANOVA דו כיווני אינה מתקיימת!
לאור התוצאות לא ניתן להשתמש במבחן ANOVA TWO-WAY לבדיקת שאלת המחקר, על כן יש לעבור לשימוש במבחנים א-פרמטריים.
</div>
<div dir="rtl">
#### **סטטיסטיקה היסקית**
</div>
<div dir="rtl" class="underlined-large-heading">
**המבחן הסטטיסטי:**
</div>
<div dir="rtl">
מבחן א-פרמטרי **Kruskal-Wallis**
</div>
<div dir="rtl">
**השערת המחקר :** קיים הבדל בין סוגי התאונות שביצעו נהגים בצורות דרכים שונות, וישנה השפעה של צורת הדרך על סוג התאונה.

**מבחן השערות :**

**H0** : אין הבדל מובהק סטטיסטית בין סוגי התאונות שביצעו נהגים בצורות דרכים שונות.

**H1** : יש הבדל מובהק סטטיסטית בין סוגי התאונות שביצעו נהגים בצורות דרכים שונות.

**הנחות המודל :**
</div>
<div dir="rtl">
1. המשתנים אינם מתפלגים בהתאם להתפלגות נורמלית.

2. המשתנה הבלתי תלוי בעל 2 קבוצות ומעלה.
</div>
<div dir="rtl">
מבחן "Kruskal-Wallis" הינו מבחן א-פרמטרי המשתמש להשוואת שתי קבוצות ומעלה, כאשר המשתנה הכמותי אינו מתפלג נורמלית. 
</div>
<div dir="rtl">
לאחר כלל הבדיקות שבוצעו עד כה, ניתן לראות כי הנתונים אינם מתפלגים נורמלית ואף כל קבוצת תצפיות בעלת שתי קבוצות לפחות (כלומר ישנן מעל 2 קבוצות של צורות דרכים ומעל 2 קבוצות של סוגי תאונות).
<div dir="ltr">
```{r, echo=FALSE}
### Because the variables are not normalliy distributed - we will use an un-parametric test

#Kroskal - wallis

##Kroskal - wallis test - Hypotheses
#cat("H0 : There is no statistically significant difference in the type of accidents (committed by drivers), on different types of road shapes.", "\n")
#cat("H1 : There is a statistically significant difference in the type of accidents (committed by drivers), on different types of road shapes.", "\n")

###Kroskal - wallis test
kruskal_testQ2 <- kruskal.test(SUG_TEUNA ~ ZURAT_DEREH, data = accColumns)
print(kruskal_testQ2)

#print result
cat("P-Value is:", kruskal_testQ2$p.value, "\n")

#Making final Decision
if (kruskal_testQ2$p.value < 0.05) {
  cat("Reject HO hypothesis (Accept H1).","\n We will conclude at a significance level of 5% ,that there is a statistically significant difference in the type of accidents committed by drivers, on different types of road shapes." ,"\n")
} else {
  cat("Accept the HO hypothesis.","\n We will conclude at a significance level of 5%,
      that there is no statistically significant difference in the type of accidents committed by drivers, on different types of road shapes." ,"\n")
}
```
</div>
<div dir="rtl">
על פי המבחן ניתן לראות כי ערך ה- P-value < 5% כלומר, אדחה את השערת H0 ברמת מובהקות של 5%, ואומר כי קיים הבדל מובהק סטטיסטית בין סוגי התאונות שמבצעים נהגים בצורות דרכים שונות.
</div>
<div dir="rtl">
אייצר מפת חום לצורך תצוגת התדירות של סוגי התאונות בצורות הדרכים השונות:
<div style="text-align:center;">
```{r, echo=FALSE, fig.width=10, fig.height=8}
# Create the heatmap
hotMap <- ggplot(Frame_group ,aes(x = ZURAT_DEREH, y =SUG_TEUNA , fill = Percentages)) +
  geom_tile(color = "azure") +
  scale_fill_gradient(low = "turquoise", high = "navy") +
  labs(title = "Heatmap of Accident Types by Road Shapes",
       x = "Road Shape",
       y = "Accident Type",
       fill = "Percentages %") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 16),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(angle = 45, hjust = 1),
        panel.background = element_blank())

print(hotMap)
```
</div>
<div dir="rtl">
בעזרת המקרא של הגרף נדע כי ככל שצבע המשבצת כהה יותר, כך תדירות התאונה מסוג מסויים גבוהה יותר.
על פי תוצאות הגרף ניתן לראות כי סוג התאונה "התנגשות אחור בחזית" המתקיימת בצורת דרך "אחר", היא בעלת אחוז תדירות התאונות הגבוה ביותר ביחס לשאר סוגי התאונות, דבר המתכנס עם גרף העמודות ההתחלתי בו נראה כי "התנגשות אחור בחזית" בעלת כמות התאונות הגבוהה ביותר, בנוסף, סוג תאונה "התנגשות חזיתית" המתקיימת בצורת דרך "יציאה / כניסה למחלף" גם היא בעלת אחוז תדירות גבוהה במיוחד בדומה למה שנראה גם בגרף העמודות המוערם של הסטטיסטיקה התיאורית.
נראה כי גם לסוג תאונה "התנגשות צד בצד" ישנה תדירות גבוהה יחסית.
התוצאות מחזקות את המסקנה כי קיים הבדל מובהק סטטיסטית בין סוגי התאונות שמבצעים נהגים בצורות דרכים שונות.
</div>
<div dir="rtl">
</div>
<div dir="rtl">
#### **מאחר ומצאתי כי קיים ההבדל הסטטיסטי שנחקר, אוכל כעת לגשת לחלקה השני של השאלה ואבדוק מה סוג התאונה וצורת הדרך הנפוצים ביותר בקרב נשים?**
</div>
<div dir="rtl">
על מנת להתחיל בביצוע המחקר על שאלה זו, אבצע סינון של טבלת הנתונים המקורית בה השתמשתי כאשר אבחר רק את הנתונים המתייחסים לנשים.
</div>
<div dir="ltr">
```{r, echo=FALSE}
####### Part 2 of the question - if there is a difference, i will find 
#the most common form of road with the highest number of accidents among women

# Filter data for woman
Woman_Accidents <- accColumns %>% filter(MIN == "Woman")

# Calculating the frequencies of type of road and type of accident for women only
woman_acc_summary <- Woman_Accidents %>%
  group_by(SUG_TEUNA, ZURAT_DEREH) %>%
  summarise(total_accidents = n(), .groups = 'drop')
print(woman_acc_summary)

# Find most common accident type for women
most_common_Type_Woman <- Mode(Woman_Accidents$SUG_TEUNA)
num_most_common_Type_Woman <- attr(most_common_Type_Woman, "freq")
print(most_common_Type_Woman)

# Find most common road shape for women
most_common_road_Shape_Woman <- Mode(Woman_Accidents$ZURAT_DEREH)
num_most_common_road_Shape_Woman <- attr(most_common_road_Shape_Woman, "freq")
print(most_common_road_Shape_Woman)

# Creating data frame
summary_table_Woman <- data.frame(
  Category = c("Type of Accident", "Road Shape"),
  Most_Common = c(most_common_Type_Woman, most_common_road_Shape_Woman),
  Frequency = c(num_most_common_Type_Woman, num_most_common_road_Shape_Woman)
)
print(summary_table_Woman)
```
</div>
<div dir="rtl">
נראה שסוג התאונה הנפוץ ביותר עבור נשים הוא "התנגשות אחור בחזית" כאשר צורת הדרך הנפוצה ביותר היא "אחר".
</div>
<div dir="rtl">
את מסקנת המחקר אוכל להציג גם באופן גרפי בעזרת גרף פיזור תלת מימדי.
</div>
<div dir="rtl" class="underlined-large-heading">
##### **גרף פיזור תלת מימדי להצגת שכיחות סוגי התאונות וצורות הדרכים בקרב נשים:**
</div>
<div style="text-align:center; margin-top:10px; margin-bottom:0px;">
```{r, echo=FALSE, fig.width=10, fig.height=8}
######Creating some graphs to show the frequencies visually I have found

#Graph - Scatter 3D graph of the freq for woman only  ### Also Mordi - Please check for me this graph of Koral

# Creating 3D scatter plot
fig <- plot_ly(
  data = woman_acc_summary,
  x = ~SUG_TEUNA,
  y = ~ZURAT_DEREH,
  z = ~total_accidents,
  type = 'scatter3d',
  mode = 'markers',
  marker = list(size = 5.5, color = ~total_accidents, colorscale = 'Viridis', showscale = TRUE)
) %>%
  layout(
    scene = list(
      xaxis = list(
        title = 'Type of Accident',
        titlefont = list(size = 14),  # Increase font size if needed
        ticktext = woman_acc_summary$SUG_TEUNA,
        tickangle = 60,
        title = list(
          standoff = 200,
          pad = list(b = 60),# Increase space between title and plot
          x = 0.5,
          xanchor = "center"
        )
      ),
      yaxis = list(
        title = 'Road Shape',
        titlefont = list(size = 14),  # Increase font size if needed
        ticktext = woman_acc_summary$ZURAT_DEREH,
        tickangle = -50,
        title = list(
          pad = list(l = 50)  # Increase space between title and plot
        )
      ),
      zaxis = list(
        title = 'Total Accidents',
        titlefont = list(size = 14),  # Increase font size if needed
        title = list(
          pad = list(t = 40)  # Increase space between title and plot
        )
      )
      
    ),
    title = list(
      text = 'Total Accidents for Women by Type of Accident and Road Shape',
      x = 0.5,   # Center the title
      xanchor = 'center',
      y = 0.9,  # Move the title closer to the plot
      yanchor = 'top'
    ),
    autosize = TRUE,  # Ensure the plot takes up most of the space
    margin = list(l = 0, r = 0, b = 0, t = 0)  # Adjust margins as needed
  )

# Show the plot
fig
```
</div>
<div dir="rtl">
**הערה:** יש לבדוק גרף זה כחלק ממתן הציון 
</div>
<div dir= "rtl">
נראה כי על פי הגרף סוג התאונה בשילוב צורת הדרך הנפוצים ביותר בקרב נשים מיוצגים ע"י הנקודה הצהובה, כך שעל פי המקרא, ככל שהצבע בהיר יותר כך השכיחות גבוהה יותר.
בהתאם לכך, נראה כי גם לפי הגרף הויזואלי, סוג התאונה הנפוץ ביותר הוא "התנגשות אחור בחזית" בצורת דרך "אחרת", כאשר מספר התאונות הוא הגבוה ביותר והינו 5,655 תאונות.
</div>
***
<div dir="rtl" class="underlined-large-heading">
#### **מקורות:**
</div>

<div dir="ltr">
* Statistics for EES and others, Comparing more than two groups: Multiple
testing, ANOVA and Kruskal-Wallis, Dirk Metzler, June 13, 2023 [Multiple testing using ANOVA and Kruskal-Wallis](https://evol.bio.lmu.de/_statgen/StatEES/anova_handout.pdf)

* Spring 2021 EDAV Community Contributions, 2021-12-11 
+Chapter 43 3D plot in R, Xinzhe Qi
+ Spring 2021 EDAV Community Contributions, 2021-12-11, Chapter 46 Common Errors in R, Emily Jennings-Dobbs 
[Creating 3D plots in R and Common Errors in R ](https://jtr13.github.io/cc21/d-plot-in-r.html)

* Package ‘plotly’, Create Interactive Web Graphics via 'plotly.js', January 13, 2024 [Using "Plotly" package for interactive plots](https://cran.r-project.org/web/packages/plotly/plotly.pdf)

* RVAideMemoire (version 0.9-83-7),Testing and Plotting Procedures for Biostatistics  [Cramer.test: Cramer's association coefficient](https://www.rdocumentation.org/packages/RVAideMemoire/versions/0.9-83-7/topics/cramer.test)

* Package ‘vcd’, Visualizing Categorical Data, December 29, 2023 [Using "vcd" package for visualizing of categorical data ](https://cran.r-project.org/web/packages/vcd/vcd.pdf)

* R CHART by R coder, pie3D function in R [Performing 3D pie charts at R](https://r-charts.com/part-whole/pie3d/)

* R Pubs, Data Science עם R - פרק 2 - ויז’ואליזציה של נתונים , עדי שריד
[R data science visualization](https://rpubs.com/adisarid/learn_R_02-visualization)

* המדריך העברי למשתמש, ויזואליזציה [Using R](https://www.hebrewr.co.il/04-visualizations-ggplot2.html)

* R Markdown from R Studio [Output Formats](https://rmarkdown.rstudio.com/lesson-9.html)

* Data visualization with ggplot2 [CHEAT SHEET](https://posit.co/wp-content/uploads/2022/10/data-visualization-1.pdf)

* R Markdown with RStudio, Roger Peng [How to use Markdown - YouTube](https://www.youtube.com/watch?v=DNS7i2m4sB0&t=318s)

* [R Markdown Reference Guide](https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf)
</div>

***